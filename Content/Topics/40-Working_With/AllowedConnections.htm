<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../../Resources/TableStyles/PatternedRows.css" rel="stylesheet" MadCap:stylesheetType="table" />
    </head>
    <body>
        <h1>Security Policy -  Allowed Connections</h1>
        <ul>
            <li><a href="#Overview">Overview</a>
            </li>
            <li><a href="#Actions">Actions Available on this Screen</a>
            </li>
            <li><a href="#How">How to Get Here</a>
            </li>
        </ul>
        <h2><a name="Overview"></a>Overview</h2>
        <p>Allowed connections are the rules governing network traffic in your cluster, constituting a security policy that can be enforced on your cluster whenever you choose. These rules can define namespaces, services and DNS names. Unlike firewall rules, they don't define IP addresses. Initially the list contains a single rule from the <MadCap:variable name="local.Kite" /> (Kite) to tufin.io and new allowed connections are defined manually, optionally assisted using the New Connections Window. The <MadCap:variable name="local.Kite" /> rule should not be deleted or changed. However, if deleted my accident it can be recreated <a href="#Adding2">manually</a> or with the help of the <a href="#Adding">New Connections Window</a>.</p>
        <p>
            <img src="../../Resources/Images/ScreenPolicyAllowedConnections.png" class="ThumbnailPopup" />
        </p>
        <p>Your policy will always be in one of two Policy Modes - <span class="StatusOrValue">Learn</span> or <span class="StatusOrValue">Enforce</span> . When in <span class="StatusOrValue">Learn</span> mode, <MadCap:variable name="local.Product_S" /> will not apply any limitations on traffic in the cluster. When in <span class="StatusOrValue">Enforce</span> mode, <MadCap:variable name="local.Product_S" /> will apply limitations on the traffic. Switching modes is done in <a href="Settings.htm">Settings</a>. </p>
        <h2><a name="Actions"></a>Actions Available on this Screen</h2>
        <ul class="Action">
            <li>Add an allowed connection by entering details yourself</li>
            <li>Add an allowed connection from the New Connections Window</li>
            <li>Delete an allowed connection</li>
            <li>Lock / unlock an allowed connection</li>
            <li>Reset allowed connections</li>
            <li>Export the security policy</li>
            <li>Apply on firewalls</li>
            <li><a href="GeneralActions.htm">General actions</a>
            </li>
        </ul>
        <h3><a name="Adding2"></a>Adding an Allowed Connection by Entering Details Yourself</h3>
        <p>To specify an allowed connection from a namespace in your cluster to a domain outside of the cluster. </p>
        <ol>
            <li>
                <p>Click on the <span class="ScreenObject">Add</span> icon (<img src="../../Resources/Images/IconAddEnforce.png" class="noborder" /> or <img src="../../Resources/Images/IconAddLearning.png" class="noborder" /> depending on the currently selected policy mode). The <span class="ScreenObject">Add Allowed Connection</span> window is displayed. </p>
                <p>
                    <img src="../../Resources/Images/WindowAddAllowedConnection.png" class="ThumbnailPopup" />
                </p>
            </li>
            <li>
                <p>Enter the details:</p>
                <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/PatternedRows.css');" class="TableStyle-PatternedRows" cellspacing="0">
                    <caption>Fields on the Screen</caption>
                    <col class="TableStyle-PatternedRows-Column-Regular" style="width: 477px;" />
                    <col class="TableStyle-PatternedRows-Column-Regular" />
                    <thead>
                        <tr class="TableStyle-PatternedRows-Head-Header1">
                            <th class="TableStyle-PatternedRows-HeadE-Regular-Header1">
                                <p class="TableHeading">Field Name</p>
                            </th>
                            <th class="TableStyle-PatternedRows-HeadD-Regular-Header1">
                                <p class="TableHeading">Value</p>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="TableStyle-PatternedRows-Body-LightRows">
                            <td class="TableStyle-PatternedRows-BodyE-Regular-LightRows">From</td>
                            <td class="TableStyle-PatternedRows-BodyD-Regular-LightRows">Click in the field to display the list of available namespaces and then click on the required value</td>
                        </tr>
                        <tr class="TableStyle-PatternedRows-Body-DarkRows">
                            <td class="TableStyle-PatternedRows-BodyB-Regular-DarkRows">To </td>
                            <td class="TableStyle-PatternedRows-BodyA-Regular-DarkRows">
                                <p>Type a valid domain name (DNS). Optionally use the wildcard character on the left of the name. This will allow multiple protocols and/or sub-domains to be included in the same rule.</p>
                                <p>Examples:&#160;api.example.io, *.example.com</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li>Click <span class="ScreenObject">Add Rule</span> . The rule will be added to the list.</li>
        </ol>
        <h3><a name="Adding"></a>Adding an Allowed Connection From the New Connections Window</h3>
        <ol class="Action">
            <li>
                <p> Any connections that have been discovered by the <a href="../20-Concepts/Discovery.htm">Discovery Engine</a> and do not exist as allowed connections in your security policy, are considered new. The number of new connections is displayed within the <span class="ScreenObject">New Connections Button</span> at the top of the screen. </p>
            </li>
            <li>
                <p>Click <span class="ScreenObject">New Connections. </span>The New Connections Window<span class="ScreenObject"> </span>is displayed.</p>
                <p>
                    <img src="../../Resources/Images/Discovery_NewConnections.png" class="ThumbnailPopup" />
                </p>
            </li>
            <li>
                <p>In the New Connections Window, click on the appropriate checkboxes to select specific new connections , or click <span class="ScreenObject">All</span>, and then click <span class="ScreenObject">Add to Policy</span>.</p>
            </li>
            <li>The selected rules will be added to your security policy and removed from the <span class="ScreenObject">New Connections Window</span>. The number of new connections on the <span class="ScreenObject">New Connections Button </span>will be updated accordingly.</li>
        </ol>
        <h3>Deleting an Allowed Connection</h3>
        <p>Rules can be deleted from the security policy at any time. </p>
        <ol>
            <li>Hover over the line for the appropriate rule and click <img src="../../Resources/Images/IconRemove.png" class="noborder" /> when it appears on the line.</li>
            <li>The allowed connection will be removed.</li>
        </ol>
        <h3><a name="Locking"></a>Locking / Unlocking an Allowed Connection</h3>
        <p>The purpose of locking rules is to prevent them from being deleted when resetting allowed connections. However, a locked rule can individually be deleted in the same way as an unlocked rule. Rules can be locked and unlocked in the security policy at any time. </p>
        <p>To lock a rule:</p>
        <ol>
            <li>Hover over the line for the appropriate rule and click the <span class="ScreenObject">Lock icon <img src="../../Resources/Images/IconUnlock.png" class="noborder"></img></span> when it appears on the line.</li>
            <li>Thereafter, the rule will display the <span class="ScreenObject">Locked icon</span> <img src="../../Resources/Images/IconLocked.png" class="noborder" /> all the time.</li>
        </ol>
        <p>To unlock a rule:</p>
        <ol>
            <li>Click the <span class="ScreenObject">Locked icon</span> <img src="../../Resources/Images/IconLocked.png" class="noborder" /> on the desired line.</li>
            <li>The <span class="ScreenObject">Locked icon</span> will be removed from the line.</li>
        </ol>
        <h3>Resetting Allowed Connections</h3>
        <p>Resetting allowed connections restores your policy to a base-line of allowed rules. All rules that have been locked constitute your base-line and if no rules have been locked, your base-line is a policy with no rules whatsoever.</p>
        <ol>
            <li>
                <p>Click on <span class="ScreenObject">Actions</span>  to display the <span class="ScreenObject">Actions</span> menu.</p>
                <p>
                    <img src="../../Resources/Images/MenuSecurityPolicyActions.png" />
                </p>
            </li>
            <li>
                <p>Click on <span class="ScreenObject">Reset Allowed Connections</span> from the menu.</p>
            </li>
            <li>
                <p>All allowed connections will be deleted from the security policy, except those that are <a href="#Locking">locked</a>.</p>
            </li>
        </ol>
        <h3><a name="Apply"></a>Export as Network Policies</h3>
        <p>The set of allowed connections - your network policy - can be exported as a YAML file which can be used to create rules in your Kubernetes cluster. </p>
        <ol>
            <li>
                <p>Click on <span class="ScreenObject">Actions</span>  to display the <span class="ScreenObject">Actions</span> menu.</p>
                <p>
                    <img src="../../Resources/Images/MenuSecurityPolicyActions.png" />
                </p>
            </li>
            <li>
                <p>Click on <span class="ScreenObject">Export as network policies </span>from the menu.</p>
            </li>
            <li>
                <p>A file named domain-&lt;your cluster name&gt;.yml will be downloaded via the browser.</p>
                <p>Sample format:</p>
                <p>
                    <img src="../../Resources/Images/yaml_network_policies.png" class="ThumbnailPopup" />
                </p>
            </li>
            <li>Take the appropriate actions described in your Kubernetes documentation to create the policies on your cluster.</li>
        </ol>
        <div class="Warning">
             This mechanism uses the namespace selector in combination with podSelector. Therefore, for the export action to work:
            <ol><li>You must be on Kubernetes 1.11 or higher</li><li>You must assign an explicit name label to your cluster namespace in the format: "namespace : &lt; namespace name &gt;"</li></ol></div>
        <h3>Apply on Firewalls</h3>
        <p>Apply on firewalls applies the security policy you have defined in <MadCap:variable name="local.Product_S" /> to the devices managed by submitting one or more firewall change tickets to your network policy change management solution. The 'apply on firewalls' function is available <span class="Bold">only</span> if you have a network policy change management solution such as <MadCap:variable name="local.SC" /> integrated with <MadCap:variable name="local.Product_L" />. Currently, <MadCap:variable name="local.SC" /> is the only application that can be integrated in this way. If there is no integration, the Apply on Firewalls option in the menu will be greyed out and unclickable, and it will show as "Apply on Firewalls (Disabled)".</p>
        <p>A ticket will be submitted for each namespace in your policy. </p>
        <p>After the apply on firewalls process is initiated, it cannot be initiated again until all tickets have been successfully implemented. If not all tickets have been implemented following a prior attempt, the menu option will be greyed out and it will show as "Apply on Firewalls (in-progress)". This status will remain until all prior tickets have been resolved and implemented or deleted in the network policy change management system.</p>
        <p>After the apply on firewalls process is initiated, the tickets created can be seen on the <a href="FirewallTickets.htm">Firewall Tickets Screen</a>, together with their status. </p>
        <ol>
            <li>
                <p>Click on <span class="ScreenObject">Actions</span>  to display the <span class="ScreenObject">Actions Menu</span>.</p>
                <p>
                    <img src="../../Resources/Images/MenuSecurityPolicyActions.png" />
                </p>
            </li>
            <li>
                <p>Click on <span class="ScreenObject">Apply on Firewalls</span> from the menu. This will initiate the process and change the option in the <span class="ScreenObject">Actions Menu</span> to be greyed out and followed by "(in-progress)". You cannot initiate the process again until the menu option is restored to its normal state. This will happen automatically when the last ticket is implemented successfully, or deleted in the change management system. Change system management tickets cannot be deleted within <MadCap:variable name="local.Product_S" />.</p>
            </li>
        </ol>
        <h2><a name="How"></a>How to Get Here</h2>
        <p><a href="Navigation.htm">Main Menu</a>  &gt; <a href="../20-Concepts/Policy.htm">Policy</a> &gt;<span class="ScreenObject">Security Policy</span></p>
    </body>
</html>